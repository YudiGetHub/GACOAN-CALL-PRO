<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gacoan Call Pro - Update By Yudi</title>
    
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f0f4f8; margin: 0; padding: 0; color: #333; }
        .main-app { padding: 15px; max-width: 600px; margin: 0 auto; text-align: center; }
        .info-box { background: white; padding: 15px; border-radius: 15px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; }
        #hariTxt { font-weight: bold; color: #1e3a8a; font-size: 18px; margin: 0; }
        #jamTxt { font-size: 24px; font-weight: bold; color: #f97316; margin: 5px 0; }
        .music-control-box { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; margin-top: 10px; }
        .btn-music-ctrl { border: none; padding: 10px 12px; border-radius: 10px; font-size: 11px; font-weight: bold; cursor: pointer; color: white; transition: 0.2s; min-width: 80px; }
        .bg-energic { background: #10b981; } 
        .bg-slow { background: #3b82f6; } 
        .bg-night { background: #6366f1; } 
        .bg-ultah { background: #db2777; } 
        .bg-pause { background: #ef4444; }
        .bg-cek { background: #64748b; width: 45%; margin-top: 5px; }
        .bg-announcement { background: #8b5cf6; width: 45%; margin-top: 5px; }
        #statusMusic { font-size: 11px; color: #64748b; font-style: italic; margin-top: 8px; display: block; }
        .header { background: #1e3a8a; color: white; padding: 15px; border-radius: 15px; margin-bottom: 15px; }
        .status-antrean { font-size: 14px; background: #ffedd5; color: #9a3412; padding: 5px 10px; border-radius: 20px; display: inline-block; margin-top: 5px; font-weight: bold; }
        .nav-tabs { display: flex; gap: 10px; margin-bottom: 15px; }
        .tab-btn { flex: 1; padding: 12px; border-radius: 12px; border: 1px solid #cbd5e1; font-weight: bold; cursor: pointer; background: white; color: #64748b; }
        .tab-btn.active { background: #1e3a8a; color: white; border-color: #1e3a8a; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; margin-bottom: 20px; }
        input { width: 90%; padding: 12px; margin: 8px 0; border: 1px solid #cbd5e1; border-radius: 10px; font-size: 16px; outline: none; }
        .btn-call { color: white; border: none; padding: 15px; border-radius: 12px; width: 100%; font-weight: bold; font-size: 16px; cursor: pointer; margin-top: 10px; }
        .bg-orange { background: #f97316; } .bg-grab { background: #00b14f; } .bg-shopee { background: #ee4d2d; } .bg-gojek { background: #00aa13; } .bg-takeaway { background: #3b82f6; }
        .grid-meja { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 10px; }
        .meja { background: white; border: 1px solid #cbd5e1; padding: 15px 5px; border-radius: 10px; font-weight: bold; color: #1e3a8a; cursor: pointer; }
        .tab-content { display: none; } .tab-content.active { display: block; }
    </style>
</head>
<body onclick="unlockAudio()" onload="mulaiAplikasi()">

    <audio id="bgmSemangat" loop preload="auto"><source src="https://actions.google.com/sounds/v1/foley/wind_chimes_short.ogg" type="audio/mpeg"></audio>
    <audio id="bgmSlow" loop preload="auto"><source src="https://actions.google.com/sounds/v1/ambiences/coffee_shop.ogg" type="audio/mpeg"></audio>
    <audio id="bgmNight" loop preload="auto"><source src="https://actions.google.com/sounds/v1/weather/rain_on_roof.ogg" type="audio/mpeg"></audio>
    <audio id="bgmUltah" preload="auto"><source src="https://www.soundboard.com/handler/DownLoadTrack.ashx?cliptitle=Happy+Birthday+Piano&filename=mt/mtkzntm0odkyndkzode2_I2_2fK_2b6pE8O0.MP3" type="audio/mpeg"></audio>

    <div class="main-app">
        <div class="info-box">
            <p id="hariTxt">Memuat...</p>
            <p id="jamTxt">00.00 WIB</p>
            <div class="music-control-box">
                <button class="btn-music-ctrl bg-energic" onclick="manualPlayMusic('bgmSemangat', 'Suara Ceria', 0.2)">üòä CERIA</button>
                <button class="btn-music-ctrl bg-slow" onclick="manualPlayMusic('bgmSlow', 'Suara Santai', 0.15)">‚òï SANTAI</button>
                <button class="btn-music-ctrl bg-night" onclick="manualPlayMusic('bgmNight', 'Suara Malam', 0.08)">üåô MALAM</button>
                <button class="btn-music-ctrl bg-ultah" onclick="modeUltah()">üéÇ ULTAH</button>
                <button class="btn-music-ctrl bg-pause" onclick="manualPauseMusic()">‚è∏ STOP</button>
                <br>
                <button class="btn-music-ctrl bg-cek" onclick="bc('Ini adalah Suara Sistem. Cek Suara sistem Berhasil', true)">‚öôÔ∏è CEK SUARA</button>
                <button class="btn-music-ctrl bg-announcement" onclick="panggilImbauanManual()">üì¢ IMBAUAN</button>
            </div>
            <span id="statusMusic">Musik: Off (Klik layar sekali)</span>
        </div>

        <div class="header">
            <h2 style="margin:0">GACOAN CALL PRO</h2>
            <div id="antreanInfo" class="status-antrean">Antrean: 0 Panggilan</div>
        </div>

        <div class="nav-tabs">
            <button class="tab-btn active" onclick="openTab('customer', event)">üë§ CUSTOMER</button>
            <button class="tab-btn" onclick="openTab('ojol', event)">üõµ OJOL & TA</button>
        </div>

        <div id="customer" class="tab-content active">
            <div class="card">
                <input type="text" id="nm" placeholder="Nama Pelanggan">
                <input type="number" id="mj" placeholder="Nomor Meja">
                <button class="btn-call bg-orange" onclick="tambahAntreanCustomer()">üì¢ PANGGIL PELANGGAN</button>
            </div>
            <div id="gt" class="grid-meja"></div>
        </div>

        <div id="ojol" class="tab-content">
            <div class="card">
                <input type="text" id="oj" placeholder="Nomor Antrean / Nama">
                <button class="btn-call bg-grab" onclick="tambahOjol('Grab Food')">üõµ GRAB FOOD</button>
                <button class="btn-call bg-shopee" onclick="tambahOjol('Shopee Food')">üõµ SHOPEE FOOD</button>
                <button class="btn-call bg-gojek" onclick="tambahOjol('Go Food')">üõµ GO FOOD</button>
                <button class="btn-call bg-takeaway" style="margin-top:20px;" onclick="tambahTA()">ü•° TAKE AWAY</button>
            </div>
        </div>
    </div>

    <script>
        let antreanSuara = [];
        let sedangBicara = false;
        let voices = [];
        let currentMusicId = null;
        let isAudioUnlocked = false;
        let defaultMusicVol = 0.15;

        window.speechSynthesis.onvoiceschanged = () => { voices = window.speechSynthesis.getVoices(); };

        function unlockAudio() {
            if (isAudioUnlocked) return;
            const audios = ['bgmSlow', 'bgmSemangat', 'bgmNight', 'bgmUltah'];
            audios.forEach(id => {
                const audio = document.getElementById(id);
                audio.play().then(() => { audio.pause(); audio.currentTime = 0; }).catch(e => console.log("Unlock audio failed"));
            });
            isAudioUnlocked = true;
            bc("Sistem Panggilan Suara siap digunakan, Diharapkan pelanggan dapat mendengar dengan baik. Terimakasih", true);
        }

        function mulaiAplikasi() {
            mulaiJam();
            window.speechSynthesis.speak(new SpeechSynthesisUtterance(""));
            setInterval(panggilImbauanManual, 900000); 
        }

        function panggilImbauanManual() {
            const pesan = [
                "Pemberitahuan kepada pelanggan yang baru datang dan ingin memesan, mohon untuk memastikan duduk sesuai dengan kapasitas meja. Terima kasih.",
                "Pemberitahuan bagi pelanggan yang sudah selesai makan, diharapkan untuk selalu mengecek kembali barang bawaannya agar tidak tertinggal di area makan. Terima kasih.",
                "Pemberitahuan bagi pelanggan yang baru datang diharapkan mengisi meja yang kosong terlebih dahulu. Terima kasih.",
                "Pemberitahuan kepada seluruh pelanggan, dimohon untuk selalu menjaga barang bawaan anda dan pastikan kendaraan anda terkunci dengan aman. Terima kasih",
                "Pemberitahuan demi kenyamanan bersama, dimohon untuk pelanggan yang ingin merokok untuk tidak di area bebas tanpa asap rokok dan tidak duduk berdampingan dengan anak kecil. Terima kasih.",
                "Pemberitahuan untuk Tisu dan Alat makan lainnya, sudah tersedia di Meja Self Service kami. Terima kasih."
            ];
            const randomPesan = pesan[Math.floor(Math.random() * pesan.length)];
            bc(randomPesan, true);
        }

        function mulaiJam() {
            setInterval(() => {
                const d = new Date();
                document.getElementById("hariTxt").innerText = ["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"][d.getDay()];
                document.getElementById("jamTxt").innerText = d.getHours().toString().padStart(2,'0') + "." + d.getMinutes().toString().padStart(2,'0') + " WIB";
            }, 1000);
        }

        function manualPlayMusic(id, label, vol) {
            unlockAudio();
            stopAllMusicInternal();
            currentMusicId = id;
            defaultMusicVol = vol;
            const m = document.getElementById(id);
            m.volume = vol;
            m.play().catch(e => console.log("Play failed"));
            document.getElementById('statusMusic').innerText = "Musik: " + label;
        }

        function manualPauseMusic() {
            stopAllMusicInternal();
            document.getElementById('statusMusic').innerText = "Musik Dimatikan";
        }

        function stopAllMusicInternal() {
            ['bgmSlow', 'bgmSemangat', 'bgmNight', 'bgmUltah'].forEach(id => {
                const m = document.getElementById(id);
                m.pause(); 
            });
            currentMusicId = null;
        }

        function modeUltah() {
            stopAllMusicInternal();
            const mUltah = document.getElementById('bgmUltah');
            currentMusicId = 'bgmUltah';
            defaultMusicVol = 0.5; 
            mUltah.volume = 0.5;
            document.getElementById('statusMusic').innerText = "Musik: Ultah üéÇ";
            
            mUltah.play().catch(e => {
                console.log("Gagal memutar lagu ultah.");
            });

            mUltah.onended = () => {
                bc("Keluarga besar Mie Gacoan mengucapkan selamat ulang tahun!", true);
            };
        }

        function bc(teks, tanpaJeda = false) {
            antreanSuara.push({ teks: teks, tanpaJeda: tanpaJeda });
            prosesAntrean();
        }

        function prosesAntrean() {
            if (sedangBicara || antreanSuara.length === 0) return;
            sedangBicara = true;
            if (currentMusicId) document.getElementById(currentMusicId).volume = 0.02;
            
            let item = antreanSuara.shift();
            document.getElementById('antreanInfo').innerText = "Antrean: " + antreanSuara.length;

            const u = new SpeechSynthesisUtterance(item.teks);
            u.voice = voices.find(v => v.lang.includes('id')) || voices[0];
            u.rate = 0.85;
            u.onend = () => { 
                if (currentMusicId) document.getElementById(currentMusicId).volume = defaultMusicVol;
                setTimeout(() => { sedangBicara = false; prosesAntrean(); }, 1500);
            };
            window.speechSynthesis.speak(u);
        }

        function tambahAntreanCustomer() {
            let n = document.getElementById('nm').value;
            let m = document.getElementById('mj').value;
            if(n && m) {
                bc("Panggilan untuk Kak " + n + ",dengan meja nomor " + m + ". Pesanan anda sudah siap. Harap Menuju Meja Self Service Sekarang juga, Terima Kasih.", true);
                document.getElementById('nm').value = ""; document.getElementById('mj').value = "";
            }
        }

        function tambahOjol(brand) {
            let input = document.getElementById('oj').value;
            if(input) {
                bc("Pesanan " + brand + " dengan nomor antrean " + input + " sudah siap. Pesanan anda sudah siap. Harap Menuju Meja TakeAway Sekarang juga, Terima Kasih.", true);
                document.getElementById('oj').value = "";
            }
        }

        function tambahTA() {
            let input = document.getElementById('oj').value;
            if(input) {
                bc("Pesanan Take Away atas nama Kak " + input + " sudah siap. Pesanan anda sudah siap. Harap Menuju Meja TakeAway Sekarang juga, Terima Kasih.", true);
                document.getElementById('oj').value = "";
            }
        }

        function openTab(tabName, event) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        const container = document.getElementById('gt');
        for (let i = 1; i <= 100; i++) {
            let b = document.createElement('button');
            b.className = 'meja'; b.innerText = i;
            b.onclick = () => bc("Panggilan Untuk Meja nomor " + i + ", Pesanan anda sudah siap. Harap Menuju Meja Self Service Sekarang juga, Terima Kasih.", true);
            container.appendChild(b);
        }
    </script>
</body>
</html>
